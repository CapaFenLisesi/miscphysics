%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

%
%
%\documentclass{article}

%\input{../peeters_macros.tex}
%\input{../peeters_macros2.tex}

%\usepackage{listings}
%\usepackage{txfonts} % for ointctr... (also appears to make "prettier" \int and \sum's)
%\usepackage[bookmarks=true]{hyperref}

%\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package.
%\usepackage{latexsym,amssymb,epsf} % do not remember if these are
   % needed, but their inclusion can not do any damage


\chapter{Some Klein-Gordon equation notes}
\label{chap:PJkgNotes}
%\author{Peeter Joot \quad peeterjoot@protonmail.com }
\date{ March 27, 2009.  kleinGordon.tex }

%\begin{document}

%\maketitle{}
%\tableofcontents
\section{Motivation}

Want to explore the ideas of global and local gauge invariance.  I seem to recall that Susskind
used the Klein-Gordon Lagrangian, which had a form something like

\begin{equation}\label{eqn:klein_gordon:densityUndeterminedCoeff}
\begin{aligned}
\LL = \partial^\mu \psi \partial_\mu \psi^\conj + \alpha m^2 \psi \psi^\conj
\end{aligned}
\end{equation}

Since this was one of the simplest forms to apply the
a relativistic gauge transformation concept to, use this for the gauge transformation exercise.  Before doing that it also seemed reasonable to
explore this relativistic QM equation slightly to get an introductory feel for it.

\section{Determine that constant}

We want

\begin{equation}\label{eqn:kleinGordon:20}
\begin{aligned}
\grad^2 \psi = \partial^\mu \partial_\mu \psi = -\frac{m^2 c^2}{\Hbar^2} \psi
\end{aligned}
\end{equation}

%FIXME: according to the
%\href{http://en.wikipedia.org/wiki/Klein-Gordon_equation}{wikipedia KG page}
%and the
%\href{http://mathworld.wolfram.com/Klein-GordonEquation.html}{wolfram KG page}
%and planet-math (URL)
%and Sdredniki
%and problem 3.10 in \citep{byron1992mca},
%I had the sign of my \(m^2\) mixed up given my use of \(+---\) metric.
% That messed up pretty much everything below, and I have attempted to
% fix it all up.

So, to start things off let us do the variation on the Lagrangian density of \eqnref{eqn:klein_gordon:densityUndeterminedCoeff}.  For fun, let us try it with Feynman's method (first order Taylor expansion, and no memorization
of the field form of the Euler-Lagrange equations).

Write \(\psi = \phi + \epsilon\), where \(\phi\) is the desired solution and \(\epsilon\) is a field that
vanishes on the boundaries of the action integral

\begin{equation}\label{eqn:kleinGordon:40}
\begin{aligned}
S
&= \int \LL d^4 x \\
&=
\int \left( \partial^\mu (\phi + \epsilon) \partial_\mu (\phi + \epsilon)^\conj + \alpha m^2 (\phi + \epsilon) (\phi + \epsilon)^\conj \right) d^4 x \\
&=
\int d^4 x \partial^\mu \phi \partial_\mu \phi^\conj
+ \alpha m^2 \int \phi \phi^\conj  d^4 x \\
&+ \int d^4 x \partial^\mu \epsilon \partial_\mu \phi^\conj
+ \int d^4 x \partial^\mu \phi \partial_\mu \epsilon^\conj  \\
&+ \alpha m^2 \int \phi \epsilon^\conj  d^4 x
+ \alpha m^2 \int \epsilon \phi^\conj  d^4 x \\
&+ \alpha m^2 \int \epsilon \epsilon^\conj  d^4 x
+ \int d^4 x \partial^\mu \epsilon \partial_\mu \epsilon^\conj \\
\end{aligned}
\end{equation}

Only the mixed \(\epsilon\), \(\phi\) terms are of interest.  The \(\phi\) only terms are the desired solution, and do not vary with \(\epsilon\), and the last two are
quadratic and can be neglected as small.  Integration by parts on the remainder we have

\begin{equation}\label{eqn:kleinGordon:60}
\begin{aligned}
\delta S
&=
\int d^4 x \partial^\mu \epsilon \partial_\mu \phi^\conj
+ \int d^4 x \partial^\mu \phi \partial_\mu \epsilon^\conj
+ \alpha m^2 \int \phi \epsilon^\conj  d^4 x
+ \alpha m^2 \int \epsilon \phi^\conj  d^4 x \\
&=
\int d^4 x \epsilon \left( -\partial^\mu \partial_\mu \phi^\conj + \alpha m^2 \phi^\conj \right)
+ \int d^4 x \left( -\partial_\mu \partial^\mu \phi + \alpha m^2 \phi \right) \epsilon^\conj
\\
&=
2 \int d^4 x \Re \left( \left( -\partial_\mu \partial^\mu \phi + \alpha m^2 \phi \right) \epsilon^\conj  \right) \\
\end{aligned}
\end{equation}

Since we want \(\delta S = 0\) for all \(\epsilon\), real or imaginary, the inner term gives us the field equation for the Lagrangian density, and we have

\begin{equation}\label{eqn:kleinGordon:80}
\begin{aligned}
\partial_\mu \partial^\mu \phi = \alpha m^2 \phi
\end{aligned}
\end{equation}

This determines the constant factor \(\alpha\) (and its sign), so we have the Lagrangian density and corresponding field equation
with all the units in place.

\begin{equation}\label{eqn:klein_gordon:withConstant}
\begin{aligned}
\partial_\mu \partial^\mu \psi &= -\frac{m^2 c^2}{\Hbar^2} \psi \\
\LL &= \partial^\mu \psi \partial_\mu \psi^\conj - \frac{m^2 c^2}{\Hbar^2}\psi \psi^\conj
\end{aligned}
\end{equation}

Now, that was not really any easier to do it that way.  Mechanically plugging into the Euler-Lagrange equations would have gotten us there faster, but Feynman's method from the Lectures \citep{feynman1963flp} is pretty cool for its simplicity.

\begin{equation}\label{eqn:kleinGordon:100}
\begin{aligned}
0
&= \partial_{\psi^\conj}\LL - \sum_\sigma \partial_\sigma \PD{(\partial_\sigma \psi^\conj)}{\LL} \\
&= -\frac{m^2 c^2}{\Hbar^2}\psi - \sum_\sigma \partial_\sigma \partial^\sigma \psi
\end{aligned}
\end{equation}

This also gives us, with less fun, the end result from the density

\begin{equation}\label{eqn:kleinGordon:120}
\begin{aligned}
\partial_\sigma \partial^\sigma \psi &= -\frac{m^2 c^2}{\Hbar^2}\psi
\end{aligned}
\end{equation}

\section{Solutions to the Klein-Gordon equation}

Pauli starts his book \citep{pauli2000wm} with this relativistic equation, pointing out that the wave packet

\begin{equation}\label{eqn:kleinGordon:140}
\begin{aligned}
\psi(\Bx,t) = \inv{(\sqrt{2\pi})^3}\int A(\Bk) e^{ i (\Bk \cdot \Bx - \omega t)} d^3 k
\end{aligned}
\end{equation}

Satisfies this relativistic scalar wave equation \eqnref{eqn:klein_gordon:withConstant}.

With a time positive metric
we have

\begin{equation}\label{eqn:kleinGordon:160}
\begin{aligned}
\grad^2
&= \partial_\mu\partial^\mu \\
&= \inv{c^2} \PDSq{t}{} - \sum_{a=1}^3 \PDSq{x^a}{} \\
&= \inv{c^2} \PDSq{t}{} - \spacegrad^2
\end{aligned}
\end{equation}

So to verify that this is a solution we can compute the derivatives for the wave equation.  Those are

\begin{equation}\label{eqn:kleinGordon:180}
\begin{aligned}
\inv{c^2} \PDSq{t} \psi(\Bx,t) = \inv{(\sqrt{2\pi})^3}\int A(\Bk) \left( \frac{(-i\omega)^2}{c^2} \right) e^{ i (\Bk \cdot \Bx - \omega t)} d^3 k
\end{aligned}
\end{equation}
\begin{equation}\label{eqn:kleinGordon:200}
\begin{aligned}
\spacegrad^2 \psi(\Bx,t) = \inv{(\sqrt{2\pi})^3}\int A(\Bk) \left(\sum_{a=1}^3 (i k_a)^2 \right)e^{ i (\Bk \cdot \Bx - \omega t)} d^3 k
\end{aligned}
\end{equation}

So we have

\begin{equation}\label{eqn:kleinGordon:220}
\begin{aligned}
\left( \grad^2 + \frac{m^2 c^2}{\Hbar^2} \right) \psi
&=
\inv{(\sqrt{2\pi})^3}\int A(\Bk) \left( -\frac{\omega^2}{c^2} + \Bk^2 + \frac{m^2 c^2}{\Hbar^2}
\right)e^{ i (\Bk \cdot \Bx - \omega t)} d^3 k
\end{aligned}
\end{equation}

For this to be zero for arbitrary wave number domain wave functions a constraint is required

\begin{equation}\label{eqn:kleinGordon:240}
\begin{aligned}
-\frac{\omega^2}{c^2} + \Bk^2 + \frac{m^2 c^2}{\Hbar^2} = 0
\end{aligned}
\end{equation}

Or with \(\omega = 2 \pi \nu\), and \(\Hbar = h/2\pi\), this is

\begin{equation}\label{eqn:kleinGordon:260}
\begin{aligned}
\frac{h^2 \nu^2}{c^2} - \Hbar^2 \Bk^2 = {m^2 c^2}
\end{aligned}
\end{equation}

This means that the constraint on the wave number vector \(\Bk\) is that it is incorporated into a four vector momentum vector as

\begin{equation}\label{eqn:kleinGordon:280}
\begin{aligned}
p &= (h \nu/c, \Hbar \Bk) \equiv (E/c, \Bp)\\
p^2 &= (m c)^2
\end{aligned}
\end{equation}

Put another way, the integral for the wave packet must not be one over all wave number space, but the wave number space defined by the
hyperbolic surface in wave number space

\begin{equation}\label{eqn:kleinGordon:300}
\begin{aligned}
\Bk^2 = \inv{\Hbar^2 c^2 }\left( (h \nu)^2 - (m c^2)^2 \right)
\end{aligned}
\end{equation}

\subsection{Wave packet as Fourier transform}

Observe that at \(t=0\) one has

\begin{equation}\label{eqn:kleinGordon:320}
\begin{aligned}
\psi(\Bx,0) = \inv{(\sqrt{2\pi})^3}\int A(\Bk) e^{ i (\Bk \cdot \Bx)} d^3 k
\end{aligned}
\end{equation}

So \(A(\Bk)\) is exactly the Fourier transform of \(\psi(\Bx,0)\)
and one can
use the Fourier transform to specify the time evolution of the wave packet in terms of initial conditions.

\begin{equation}\label{eqn:kleinGordon:340}
\begin{aligned}
\psi(\Bx,t) = \inv{(\sqrt{2\pi})^3}\int \hat{\psi}_0(\Bk) e^{ i (\Bk \cdot \Bx - \omega t)} d^3 k
\end{aligned}
\end{equation}

That is actually a fairly odd seeming constraint.  We have a volume integral over a surface of zero thickness unless \(\nu\) varies.  Intuitively
I had expect that to be zero, so this wave packet form does not seem particularly well defined as stated.  Perhaps the value, as
in Pauli's text, is really just to motivate the relativistic wave equation?

\subsection{Normalization}

Although Pauli incorporated the \(2\pi\) factors into \(A(\Bk)\), leaving these explicit allows for the normalization of the wave number and spatial domains
to be identical.

\begin{equation}\label{eqn:kleinGordon:360}
\begin{aligned}
\int
\psi(\Bx,t) \psi^\conj(\Bx,t) d^3 \Bx
&=
\inv{({2\pi})^3}
\iiint d^3 x
\hat{\psi}_0(\Bk) e^{ i (\Bk \cdot \Bx - \omega t)} d^3 k
\widehat{\psi^\conj}_0(\Bk') e^{ -i (\Bk' \cdot \Bx - \omega t)} d^3 k'
\\
&=
\iint \hat{\psi}_0(\Bk) \widehat{\psi^\conj}_0(\Bk')
d^3 k d^3 k'
\inv{({2\pi})^3} \int e^{ i ((\Bk- \Bk') \cdot \Bx)} d^3 x
\\
&=
\iint \hat{\psi}_0(\Bk) \widehat{\psi^\conj}_0(\Bk') \delta^3(\Bk-\Bk') d^3 k d^3 k'
\\
&=
\int \hat{\psi}_0(\Bk) \widehat{\psi^\conj}_0(\Bk) d^3 k
\\
\end{aligned}
\end{equation}

So, if one has a unit normalized wave packet in the spatial domain, the wave number domain has the same normalization

\begin{equation}\label{eqn:kleinGordon:380}
\begin{aligned}
\int \Abs{\psi(\Bx,t)} d^3 \Bx = \int \Abs{\hat{\psi}_0(\Bk)} d^3 k
\end{aligned}
\end{equation}

\section{Probability current?}

Given the wave equation and an interpretation of \(1 = \int \Abs{\psi}^2\) as a probability, can one define a probability current meaningfully.  This
seems somewhat problematic logically, since computing the derivative, as done in \citep{gabookII:PJprobCurrent}

\begin{equation}\label{eqn:kleinGordon:400}
\begin{aligned}
\PD{t}{\psi\psi^\conj} = \PD{t}{\psi}\psi^\conj + \psi \PD{t}{\psi^\conj}
\end{aligned}
\end{equation}

leaves us with nowhere to go.  For the
Schr\"{o}dinger equation probability density, this calculation gave us

\begin{equation}\label{eqn:klein_gordon:pcons}
\begin{aligned}
\rho &= \psi\psi^\conj \\
\BJ &= \frac{\Hbar}{2mi} \left( \psi^\conj \spacegrad \psi - \psi \spacegrad \psi^\conj \right) \\
0 &= \PD{t}{\rho} + \spacegrad \cdot \BJ
\end{aligned}
\end{equation}

However for the KG equation we do not have any sort of expression for \(\PD{t}{\psi}\) since it is second order.

\subsection{Second order derivatives of the probability density}

One could, however, compute a second order derivatives of the density, but does this product anything useful?

\begin{equation}\label{eqn:kleinGordon:420}
\begin{aligned}
\PDSq{t}{\psi\psi^\conj}
&= \PD{t}{}\left( \PD{t}{\psi}\psi^\conj + \psi \PD{t}{\psi^\conj} \right) \\
&=
\PDSq{t}{\psi}\psi^\conj
+ \psi \PDSq{t}{\psi^\conj}
+ 2 \PD{t}{\psi}\PD{t}{\psi^\conj}
\\
\end{aligned}
\end{equation}

But we have

\begin{equation}\label{eqn:kleinGordon:440}
\begin{aligned}
\PDSq{t}{\psi} = c^2 \spacegrad^2 \psi - \left(\frac{m c^2}{\Hbar} \right)^2 \psi
\end{aligned}
\end{equation}

This gives
\begin{equation}\label{eqn:kleinGordon:460}
\begin{aligned}
\PDSq{t}{\psi\psi^\conj}
&=
\left( c^2 \spacegrad^2 \psi - \left(\frac{m c^2}{\Hbar} \right)^2 \psi \right) \psi^\conj
+ \psi \left( c^2 \spacegrad^2 \psi^\conj - \left(\frac{m c^2}{\Hbar} \right)^2 \psi^\conj \right)
+ 2 \PD{t}{\psi}\PD{t}{\psi^\conj}
\\
&=
c^2 \left( \psi^\conj \spacegrad^2 \psi + \psi \spacegrad^2 \psi^\conj \right)
+ 2 \left(
\PD{t}{\psi}\PD{t}{\psi^\conj} - \left( \frac{m c^2}{\Hbar} \right)^2 \psi \psi^\conj
\right)
\\
\end{aligned}
\end{equation}

The first two Laplacian terms can be expressed as divergences with

\begin{equation}\label{eqn:kleinGordon:480}
\begin{aligned}
\spacegrad \cdot (a \spacegrad b)
&=
\gpgradezero{ \spacegrad (a \spacegrad b) } \\
&=
(\spacegrad a) \cdot (\spacegrad b) + a \spacegrad^2 b
\end{aligned}
\end{equation}

This gives

\begin{equation}\label{eqn:kleinGordon:500}
\begin{aligned}
\PDSq{t}{\psi\psi^\conj}
&=
c^2 \spacegrad \cdot \left( \psi \spacegrad \psi^\conj +\psi^\conj \spacegrad \psi \right)
+ 2 \left(
\PD{t}{\psi}\PD{t}{\psi^\conj} - \left( \frac{m c^2}{\Hbar} \right)^2 \psi \psi^\conj
-c^2 (\spacegrad \psi) \cdot (\spacegrad \psi^\conj)
\right)
\\
\end{aligned}
\end{equation}

Integrating over all space (assuming the fields vanish at infinity), the divergence terms drop out, and one is left with
\begin{equation}\label{eqn:kleinGordon:520}
\begin{aligned}
\int \left( \PDSq{t}{\psi\psi^\conj}
+ 2 c^2 (\spacegrad \psi) \cdot (\spacegrad \psi^\conj)
- 2 \PD{t}{\psi}\PD{t}{\psi^\conj}  \right)
&=
-2 \left( \frac{m c^2}{\Hbar} \right)^2
\\
\end{aligned}
\end{equation}

This is kind of funny, since it almost takes us full circle back to the Lagrangian we started with.  Putting everything
back into the integral and grouping together

\begin{equation}\label{eqn:kleinGordon:540}
\begin{aligned}
\int \inv{2 c^2} \PDSq{t}{\psi\psi^\conj}
&=
\int
\left(
\PD{ct}{\psi}\PD{ct}{\psi^\conj}
- (\spacegrad \psi) \cdot (\spacegrad \psi^\conj)
- \frac{m^2 c^2}{\Hbar^2} \psi \psi^\conj
\right)
\\
&=
\int
\left(
\grad \psi \cdot \grad \psi^\conj
- \frac{m^2 c^2}{\Hbar^2} \psi \psi^\conj
\right)
\\
\end{aligned}
\end{equation}

So we have

\begin{equation}\label{eqn:kleinGordon:560}
\begin{aligned}
\int d^3 x \LL &= \inv{2} \int d^3 x \PDSq{ct}{\psi\psi^\conj}
\end{aligned}
\end{equation}

On the LHS it almost looks like the original action, but it is integrated over space instead of spacetime.  This integral
whatever it is, ends up expressible in terms of just the time derivatives, so there is a somewhat natural seeming space and time
pairing here.

\section{Radial solution}

What does separation of variables yield for this equation?  Let

\begin{equation}\label{eqn:kleinGordon:580}
\begin{aligned}
\psi(\Bx,t) = \phi(\Bx)\tau(t)
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:kleinGordon:600}
\begin{aligned}
\grad^2 \psi
&= \left(\inv{c^2} \PDSq{t}{} - \spacegrad^2 \right) \phi(\Bx)\tau(t) \\
&= \inv{c^2} \phi\tau'' - \tau \spacegrad^2 \phi \\
&= -\frac{m^2 c^2}{\Hbar^2}\phi\tau
\end{aligned}
\end{equation}

So we have
\begin{equation}\label{eqn:kleinGordon:620}
\begin{aligned}
\inv{c^2} \frac{\tau''}{\tau} - \inv{\phi} \spacegrad^2 \phi &= -\frac{m^2 c^2}{\Hbar^2}
\end{aligned}
\end{equation}

Let \(\tau''/\tau = c^2 \kappa^2\), for some constant \(\kappa\), perhaps imaginary. This gives

\begin{equation}\label{eqn:kleinGordon:640}
\begin{aligned}
\spacegrad^2 \phi &= \left( \kappa^2 + \frac{m^2 c^2}{\Hbar^2} \right) \phi
\end{aligned}
\end{equation}

Introducing one additional constant

\begin{equation}\label{eqn:kleinGordon:660}
\begin{aligned}
\mu^2 &= \kappa^2 + \frac{m^2 c^2}{\Hbar^2}
\end{aligned}
\end{equation}

The spatial component of the equation becomes

\begin{equation}\label{eqn:kleinGordon:680}
\begin{aligned}
\left( \spacegrad^2 - \mu^2 \right) \phi &= 0
\end{aligned}
\end{equation}

Now, let us return to the equation for \(\tau\) and integrate.  If \(\kappa\) is real then the solutions are linear
combinations of hyperbolic functions

\begin{equation}\label{eqn:kleinGordon:700}
\begin{aligned}
\tau = A_{\pm} e^{\pm \kappa c t}
\end{aligned}
\end{equation}

Here is where the math allows more than seems regular in a physical context.  Hyperbolic seem a bit irregular for the time term of a wave function, so it probably makes sense to make \(\kappa\)
pure imaginary, say \(\kappa = i k\).  Then we have a sinusoidal phase term for the time dependent function

\begin{equation}\label{eqn:kleinGordon:720}
\begin{aligned}
\tau = A_{\pm} e^{\pm i k c t}
\end{aligned}
\end{equation}

and the spatial remainder takes the form of a Helmholtz equation.

\begin{equation}\label{eqn:kleinGordon:740}
\begin{aligned}
\left( \spacegrad^2 + \left( k^2 + \frac{m^2 c^2}{\Hbar^2} \right) \right) \phi &= 0
\end{aligned}
\end{equation}

The Helmholtz equation is also what we would have gotten with separation of variables for an unforced wave
equation, so the spatial solution of the Klein Gordon equation takes the same form as solutions to the
homogeneous wave equation (example: plane waves or superpositions of them), but with the wave number vector magnitude is shifted due to the inclusion of
the \(m^2 c^2/\Hbar^2\) constant term in the equation above.

\section{Gauge transformation}

The concept of gauge transformation is explained very nicely in \citep{vtgauge}.  Work through this
for the KG Lagrangian.

\subsection{Constant phase change}

A global gauge transformation that changes phase everywhere by some constant amount

\begin{equation}\label{eqn:kleinGordon:760}
\begin{aligned}
\psi' = \psi e^{i\theta}
\end{aligned}
\end{equation}

does not change the Lagrangian

\begin{equation}\label{eqn:kleinGordon:780}
\begin{aligned}
\LL'
&= \partial^\mu \psi'  \partial_\mu {\psi'}^\conj - \frac{m^2 c^2}{\Hbar^2}\psi' {\psi'}^\conj \\
&= \partial^\mu \psi e^{i\theta} \partial_\mu \psi^\conj e^{-i\theta} - \frac{m^2 c^2}{\Hbar^2}\psi e^{i\theta}\psi^\conj e^{-i\theta} \\
&= \LL
\end{aligned}
\end{equation}

Because of the symmetry Noether's theorem can be applied to find a conserved quantity.  In this simple case the Noether's equation is not really necessary.
Instead, the conserved quantity can be computed directly.

\begin{equation}\label{eqn:kleinGordon:800}
\begin{aligned}
\frac{d\LL'}{d\theta}
&=
\PD{\psi'}{\LL'} \PD{\theta}{\psi'}
+\PD{{\psi'}^\conj}{\LL'} \PD{\theta}{{\psi'}^\conj}
+\PD{(\partial_\mu \psi')}{\LL'} \PD{\theta}{(\partial_\mu \psi')}
+\PD{(\partial_\mu {\psi'}^\conj)}{\LL'} \PD{\theta}{(\partial_\mu {\psi'}^\conj)} \\
\end{aligned}
\end{equation}

Note that summation over \(\mu\) is implied here, so this is really a chain rule expansion with respect to all ten field variables.

At \(\theta=0\), \(\psi' = \psi\), and this derivative is

\begin{equation}\label{eqn:kleinGordon:820}
\begin{aligned}
{\left. \frac{d\LL'}{d\theta} \right\vert}_{\theta=0}
&=
-\frac{m^2 c^2}{\Hbar^2}\left( \psi^\conj (i \psi) + \psi (-i\psi^\conj) \right)
+ \partial^\mu \psi^\conj (i\partial_\mu \psi)
+ \partial^\mu \psi (-i \partial_\mu {\psi}^\conj) \\
\end{aligned}
\end{equation}

The first term is zero, and one can guess that the remainder can be written as a divergence as follows (with confirmation)

\begin{equation}\label{eqn:kleinGordon:840}
\begin{aligned}
i \partial_\mu \left(
\psi \partial^\mu \psi^\conj
-\psi^\conj \partial^\mu \psi
\right)
&=
i \left(
\partial_\mu \psi \partial^\mu \psi^\conj
-\partial_\mu \psi^\conj \partial^\mu \psi
+\psi \partial_\mu \partial^\mu \psi^\conj
-\psi^\conj \partial_\mu \partial^\mu \psi
\right) \\
&=
i \left(
\partial_\mu \psi \partial^\mu \psi^\conj
-\partial_\mu \psi^\conj \partial^\mu \psi \right)
- \frac{ i m^2 c^2}{\Hbar^2} \left(
\psi \psi^\conj
-\psi^\conj \psi
\right) \\
\end{aligned}
\end{equation}

(confirming the guess).

We therefore have a spacetime divergence of zero for this current, namely

\begin{equation}\label{eqn:kleinGordon:860}
\begin{aligned}
J^\mu &=
i \left(
\psi \partial^\mu \psi^\conj
-\psi^\conj \partial^\mu \psi
\right) \\
\partial_\mu J^\mu &= 0
\end{aligned}
\end{equation}

In GA form, with \(J = \gamma_\mu J^\mu\), and \(\grad = \gamma^\mu \partial_\mu\) this is

\begin{equation}\label{eqn:kleinGordon:880}
\begin{aligned}
J &=
i \left(
\psi \grad \psi^\conj
-\psi^\conj \grad \psi
\right) \\
\grad \cdot J &= 0
\end{aligned}
\end{equation}

A relation very much like the vector probability current of the non-relativistic Schr\"{o}dinger equation.  We have seen above, however, that
unlike the non-relativistic equation, because we lack first order time derivatives, we do not have a way to relate this to the probability density
\(\rho = \psi\psi^\conj\).

Working through this helps clarify why the requirement for interpretation of \(\rho\) as a probability current with the
corresponding continuity equation was highlighted in \citep{bohm1989qt} as one of the reasons for requiring a first order in time wave equation.

Also see here that this is exactly the result that was found in \citep{classicalmechanics:PJNoethersField} where the Noether equation for the conserved current
was derived.  Working this out by direct calculation, however, provides a nice lead in to an attempt to do the same for non-constant \(\theta\)
(local gauge transformation).

\subsection{Local gauge transformation}

Now, if one lets the field transformation vary with space and time

\begin{equation}\label{eqn:kleinGordon:900}
\begin{aligned}
\theta = \theta(x^\mu)
\end{aligned}
\end{equation}

Then there will be less cancellation in the transformed Lagrangian, and it will no longer be invariant.  We have

\begin{equation}\label{eqn:kleinGordon:920}
\begin{aligned}
\psi' &= \psi e^{i\theta} \\
{\psi'}^\conj &= \psi^\conj e^{-i\theta} \\
\partial_\mu \psi' &= (\partial_\mu \psi + i \psi \partial_\mu \theta ) e^{i\theta}  \\
\partial^\mu {\psi'}^\conj &= (\partial^\mu \psi^\conj - i \psi^\conj \partial^\mu \theta) e^{-i\theta} \\
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:kleinGordon:940}
\begin{aligned}
\LL'
&= \partial_\mu \psi' \partial^\mu {\psi'}^\conj - \frac{m^2 c^2}{\Hbar^2} \psi' {\psi'}^\conj \\
&=
(\partial_\mu \psi + i \psi \partial_\mu \theta ) (\partial^\mu \psi^\conj - i \psi^\conj \partial^\mu \theta)
- \frac{m^2 c^2}{\Hbar^2} \psi {\psi}^\conj \\
&=
\partial_\mu \psi \partial^\mu \psi^\conj
-i (\partial_\mu \psi) \psi^\conj (\partial^\mu \theta)
+ i \psi (\partial_\mu \theta) (\partial^\mu \psi^\conj)
+ \left( -\frac{m^2 c^2}{\Hbar^2} + \partial_\mu \theta \partial^\mu \theta \right) \psi {\psi}^\conj \\
&=
\partial_\mu \psi \partial^\mu \psi^\conj
+ (\partial_\mu \theta) J^\mu %\left( i \psi (\partial^\mu \psi^\conj) -i (\partial^\mu \psi) \psi^\conj \right)
+ \left( -\frac{m^2 c^2}{\Hbar^2} + \partial_\mu \theta \partial^\mu \theta \right) \psi {\psi}^\conj \\
\end{aligned}
\end{equation}

Introduction of a four vector \(A^\mu = \partial^\mu \theta\), the transformed Lagrangian becomes

\begin{equation}\label{eqn:kleinGordon:960}
\begin{aligned}
\LL'
&=
\partial_\mu \psi \partial^\mu \psi^\conj
+ A_\mu J^\mu
+ \left( -\frac{m^2 c^2}{\Hbar^2} + A_\mu A^\mu \right) \psi {\psi}^\conj \\
&=
(\grad \psi) \cdot (\grad \psi^\conj) + A \cdot J
+ \left( -\frac{m^2 c^2}{\Hbar^2} + A^2 \right) \psi {\psi}^\conj
\end{aligned}
\end{equation}

So if the local gauge transformation is interpreted as supplying an external electromagnetic potential \(A\), we have the same \(A \cdot J\) coupling term
as we have in the Maxwell field Lagrangian, but the current here is the probability current, rather than the electric charge/current density vector.  Also
somewhat curiously, we have the square of the potential \(A\) showing up as a mass term.

\subsubsection{Gauge invariant form}

Our transformed Lagrangian can now be written (dropping primes)

\begin{equation}\label{eqn:klein_gordon:gaugeInvariant}
\begin{aligned}
\LL(\psi, A)
&=
(\grad \psi + i \psi A) \cdot (\grad \psi + i \psi A)^\conj
- \frac{m^2 c^2}{\Hbar^2} \psi {\psi}^\conj
\end{aligned}
\end{equation}

Making an additional local transformation \(\psi \rightarrow \psi e^{i\alpha}\), and writing \(B^\mu = \partial^\mu \alpha\) the new transformed Lagrangian becomes

\begin{equation}\label{eqn:kleinGordon:980}
\begin{aligned}
\LL' = \LL(\psi', A')
&=
(\grad \psi + i \psi (A'+B)) \cdot (\grad \psi + i \psi (A'+B))^\conj
- \frac{m^2 c^2}{\Hbar^2} \psi {\psi}^\conj \\
\end{aligned}
\end{equation}

So, if one requires that \(A\) transforms as \(A^\mu \rightarrow A^\mu - \partial^\mu \alpha = {A'}^\mu\) (ie: \(A' = A - B\)), then we have \(\LL' = \LL\), and
the new Lagrangian is locally gauge invariant.

We see that local gauge invariance requires that a potential term be included in the Lagrangian
, as in \eqnref{eqn:klein_gordon:gaugeInvariant}, and additionally that both this potential and the wave field transform in pairs, say,

\begin{equation}\label{eqn:kleinGordon:1000}
\begin{aligned}
\psi &\rightarrow \psi e^{i\alpha} \\
A^\mu &\rightarrow A^\mu - \partial^\mu \alpha
\end{aligned}
\end{equation}

This is exactly what Susskind covered in his relativity lecture on iTunesU, but going over it all myself, albeit rather after the fact, firms up the ideas.  How
do these ideas apply to the Maxwell Lagrangian ... the expectation is that one can start with the free space form, and find the coupling term \(A \cdot J\) via a
gauge transformation of some sort?  Would also like to work through this myself for the non-relativistic wave Lagrangian.


\subsubsection{Gauge covariant derivative}

Observe that in \eqnref{eqn:klein_gordon:gaugeInvariant}, we also have something that looks
like the
gauge covariant derivative of the Dirac equation

\begin{equation}\label{eqn:kleinGordon:1020}
\begin{aligned}
%D\!\!\!/
\Dslash
&= \grad - i A \\
&\equiv \gamma^\mu \partial_\mu - i \gamma_\mu A^\mu
\end{aligned}
\end{equation}

Using this, the gauge transformed Lagrangian can be written

\begin{equation}\label{eqn:kleinGordon:1040}
\begin{aligned}
\LL
&=
(\Dslash^\conj \psi) \cdot (\Dslash \psi^\conj)
- \frac{m^2 c^2}{\Hbar^2} \psi {\psi}^\conj
\end{aligned}
\end{equation}

This is tidier, but comes with the cost of hiding even more in the notation.

\subsubsection{Field equations for the gauge Lagrangian?}

What sort of field equation do we end up with after the local gauge transformation that alters the Lagrangian?  Let us compute this, starting with the transformed density written out in full

\begin{equation}\label{eqn:kleinGordon:1060}
\begin{aligned}
\LL
&=
\partial^\mu \psi \partial_\mu \psi^\conj
+ A_\mu %J^\mu
i \left(
\psi \partial^\mu \psi^\conj
-\psi^\conj \partial^\mu \psi
\right)
+ \left( -\frac{m^2 c^2}{\Hbar^2} + A_\mu A^\mu \right) \psi {\psi}^\conj \\
\end{aligned}
\end{equation}

Computing the Euler Lagrange equations, for a variation in \(\psi^\conj\) we have

\begin{equation}\label{eqn:kleinGordon:1080}
\begin{aligned}
0 &=
\PD{\psi^\conj}{\LL}
- \partial_\mu \PD{(\partial_\mu \psi^\conj)}{\LL} \\
&= -i A_\mu \partial^\mu \psi
+ \left( -\frac{m^2 c^2}{\Hbar^2} + A_\mu A^\mu \right) \psi
-\partial_\mu \partial^\mu \psi  + i \partial_\mu (A^\mu \psi) \\
&= -i A_\mu \partial^\mu \psi
+ \left( -\frac{m^2 c^2}{\Hbar^2} + A_\mu A^\mu \right) \psi
-\partial_\mu \partial^\mu \psi
+ i (\partial_\mu A^\mu) \psi
+ i A^\mu (\partial_\mu \psi) \\
\end{aligned}
\end{equation}

Toggling indices on the last term, allows it to cancel with the first, and we are left with

\begin{equation}\label{eqn:kleinGordon:1100}
\begin{aligned}
\grad^2 \psi
&= \left( -\frac{m^2 c^2}{\Hbar^2} + A^2 + i (\grad \cdot A) \right) \psi
\end{aligned}
\end{equation}

If \(A\) is an electromagnetic potential four vector calculated in the Lorentz gauge where one can choose \(\grad \cdot A = 0\),
then the net effect of the gauge variation is to add a \(A^\mu A_\mu\) vector product (a Lorentz invariant) to the mass term.  In the Dirac equation I think we have that too, but the potential shows up instead coupled to the field in a first
order power.

Now, comparing to problem 3.10 of \citep{byron1992mca} as worked in \chapcite{PJbyronFullerCalcVarProblems} the last two terms here differ by a sign factor, and there is also
no \(A \cdot \grad\) term (where I had two such terms instead of an exact cancellation as was the case here).  Is there an error above, or in my solution to this problem?

\section{Stress energy tensor}

For completeness sake it would be nice to derive the stress energy tensor
for the KG equation here.  Both \citep{srednicki2007qft} and \citep{doran2003gap} mention that this is the resulting symmetry from
a spacetime translation.  D/L's treatment is pretty incomprehensible to me
at the moment, and will take a lot more study before I understand
it.  Perhaps I can blunder through it on my own without the GA infrastructure?

TODO (for both the potential free and gauge potential cases).

%\bibliographystyle{plainnat}
%\bibliography{myrefs}

%\end{document}
